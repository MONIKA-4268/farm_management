<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FarmPortal - Log Entry & Search</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(120deg, #e0f7fa 0%, #ffe0b2 100%);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .navbar { background: #fff3e0 !important; }
    .navbar-brand { color: #388e3c !important; font-weight: bold; font-size: 2rem; letter-spacing: 2px; }
    .nav-link.active { color: #338851 !important; font-weight: bold; }
    .tab-section { display: none; animation: fadeInDown 0.4s; padding-top: 1rem; }
    .active-section { display: block !important; }
    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light shadow-sm">
    <a class="navbar-brand" href="#"><i class="fas fa-leaf"></i> FarmPortal</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navMenu">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navMenu">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item"><a class="nav-link" href="#" id="navDashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="#" id="navLivestock"><i class="fas fa-cow"></i> Livestock</a></li>
        <li class="nav-item"><a class="nav-link" href="#" id="navMRL"><i class="fas fa-vial"></i> MRL</a></li>
        <li class="nav-item"><a class="nav-link" href="#" id="navAMU"><i class="fas fa-syringe"></i> AMU Logs</a></li>
      </ul>
      <button id="logout-btn" class="btn btn-outline-danger my-2 my-sm-0"><i class="fa fa-sign-out-alt"></i> Logout</button>
    </div>
  </nav>

  <!-- Dashboard -->
  <div class="container tab-section" id="dashboard">
    <h2></h2>
    <p></p>
  </div>

  <!-- Livestock Section -->
  <div class="container tab-section" id="livestock-section">
    <h3 class="mt-3"><i class="fas fa-cow"></i> </h3>

    <form id="livestock-form" class="form-inline mb-3 bg-white p-3 rounded shadow-sm">
      <input type="text" class="form-control mr-2 mb-2" name="species" required />
      <input type="text" class="form-control mr-2 mb-2" name="breed" required />
      <input type="text" class="form-control mr-2 mb-2" name="tagNo" required />
      <button type="submit" class="btn btn-success mb-2"><i class="fas fa-plus"></i> </button>
    </form>

    <input type="text" id="livestock-search" class="form-control mb-3" />

    <div class="table-responsive bg-white p-2 rounded shadow-sm">
      <table class="table table-bordered text-center" id="livestock-table">
        <thead><tr><th></th><th></th><th></th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- MRL Section -->
  <div class="container tab-section" id="mrl-section">
    <h3 class="mt-3"><i class="fas fa-vial"></i> </h3>

    <form id="mrl-form" class="form-inline mb-3 bg-white p-3 rounded shadow-sm">
      <input type="text" class="form-control mr-2 mb-2" name="chemical" required />
      <input type="text" class="form-control mr-2 mb-2" name="species" required />
      <input type="number" class="form-control mr-2 mb-2" name="maxResidue" step="0.01" required />
      <button type="submit" class="btn btn-warning text-white mb-2"><i class="fas fa-plus"></i> </button>
    </form>

    <input type="text" id="mrl-search" class="form-control mb-3" />

    <div class="table-responsive bg-white p-2 rounded shadow-sm">
      <table class="table table-bordered text-center" id="mrl-table">
        <thead><tr><th></th><th></th><th></th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- AMU Section -->
  <div class="container tab-section" id="amu-section">
    <h3 class="mt-3"><i class="fas fa-syringe"></i> </h3>

    <form id="amu-form" class="form-inline mb-3 bg-white p-3 rounded shadow-sm">
      <input type="text" class="form-control mr-2 mb-2" name="tagNo" required />
      <input type="text" class="form-control mr-2 mb-2" name="chemical" required />
      <input type="date" class="form-control mr-2 mb-2" name="date" required />
      <input type="text" class="form-control mr-2 mb-2" name="dosage" required />
      <button type="submit" class="btn btn-danger mb-2"><i class="fas fa-plus"></i> </button>
    </form>

    <input type="text" id="amu-search" class="form-control mb-3" />

    <div class="table-responsive bg-white p-2 rounded shadow-sm">
      <table class="table table-bordered text-center" id="amu-table">
        <thead><tr><th></th><th></th><th></th><th></th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
  <script>
    // Language dictionary for Tamil and English
    const lang = localStorage.getItem('language') || 'en';
    const dict = {
      en: {
        dashboard: 'Dashboard',
        livestock: 'Livestock',
        mrl: 'MRL',
        amuLogs: 'AMU Logs',
        logout: 'Logout',
        dashboardWelcome: 'Welcome to FarmPortal Dashboard',
        dashboardDesc: 'Use navigation above to manage Livestock, MRL, and AMU logs.',
        manageLivestock: 'Manage Livestock',
        speciesPlaceholder: 'Species',
        breedPlaceholder: 'Breed',
        tagNoPlaceholder: 'Tag No.',
        addLivestockBtn: 'Add Livestock',
        searchLivestockPlaceholder: 'Search Livestock...',
        manageMRL: 'Manage Maximum Residue Limits (MRL)',
        chemicalPlaceholder: 'Chemical',
        mrlSpeciesPlaceholder: 'Species',
        maxResiduePlaceholder: 'Max Residue (mg/kg)',
        addMRLBtn: 'Add MRL',
        searchMRLPlaceholder: 'Search MRL...',
        logAMU: 'Log Antimicrobial Usage (AMU)',
        amuTagNoPlaceholder: 'Livestock Tag No.',
        amuChemicalPlaceholder: 'Chemical',
        amuDatePlaceholder: 'Date',
        amuDosagePlaceholder: 'Dosage',
        logAMUBtn: 'Log AMU',
        searchAMUPlaceholder: 'Search AMU Logs...'
      },
      ta: {
        dashboard: '[டாஷ்போர்டு]',
        livestock: '[மிருகபாலை]',
        mrl: '[அதிகபட்ச இருப்பு வரம்புகள்]',
        amuLogs: '[மருந்து பயன்பாட்டு பதிவுகள்]',
        logout: '[வெளியேறு]',
        dashboardWelcome: '[FarmPortal தளத்திற்கு வரவேற்கின்றோம்]',
        dashboardDesc: '[மேலே உள்ள வழிசெலுத்தலைப் பயன்படுத்தி மிருகபாலை, MRL மற்றும் AMU பதிவுகளை நிர்வகிக்கவும்.]',
        manageLivestock: '[மிருகபாலை நிர்வகி]',
        speciesPlaceholder: '[வகை]',
        breedPlaceholder: '[சீரியல்]',
        tagNoPlaceholder: '[தொகுதி எண்]',
        addLivestockBtn: '[மிருகபாலைச் சேர்]',
        searchLivestockPlaceholder: '[:மிருகபாலைத் தேடு...]',
        manageMRL: '[அதிகபட்ச இருப்பு அளவு (MRL) நிர்வகி]',
        chemicalPlaceholder: '[கொழும்பு]',
        mrlSpeciesPlaceholder: '[வகை]',
        maxResiduePlaceholder: '[அதிகபட்ச இருப்பு (மி.கி/கி)]',
        addMRLBtn: '[MRL சேர்க்க]',
        searchMRLPlaceholder: '[MRL தேடு...]',
        logAMU: '[மருந்து பயன்பாடு பதிவு]',
        amuTagNoPlaceholder: '[மிருகபாலை தொகுதி எண்]',
        amuChemicalPlaceholder: '[மருந்து]',
        amuDatePlaceholder: '[தேதி]',
        amuDosagePlaceholder: '[கால அளவு]',
        logAMUBtn: '[மருந்து பதிவு செய்]',
        searchAMUPlaceholder: '[AMU பதிவுகளைத் தேடு...]'
      }
    };

    // Function to update UI text based on language
    function setLanguageUI(lang) {
      // Navbar
      document.getElementById('navDashboard').textContent = dict[lang].dashboard;
      document.getElementById('navLivestock').textContent = dict[lang].livestock;
      document.getElementById('navMRL').textContent = dict[lang].mrl;
      document.getElementById('navAMU').textContent = dict[lang].amuLogs;
      document.getElementById('logout-btn').innerHTML = `<i class="fa fa-sign-out-alt"></i> ${dict[lang].logout}`;

      // Dashboard
      document.querySelector('#dashboard h2').textContent = dict[lang].dashboardWelcome;
      document.querySelector('#dashboard p').textContent = dict[lang].dashboardDesc;

      // Livestock Section
      document.querySelector('#livestock-section h3').textContent = dict[lang].manageLivestock;
      document.querySelector('#livestock-form input[name="species"]').placeholder = dict[lang].speciesPlaceholder;
      document.querySelector('#livestock-form input[name="breed"]').placeholder = dict[lang].breedPlaceholder;
      document.querySelector('#livestock-form input[name="tagNo"]').placeholder = dict[lang].tagNoPlaceholder;
      document.querySelector('#livestock-form button').innerHTML = `<i class="fas fa-plus"></i> ${dict[lang].addLivestockBtn}`;
      document.getElementById('livestock-search').placeholder = dict[lang].searchLivestockPlaceholder;

      // MRL Section
      document.querySelector('#mrl-section h3').textContent = dict[lang].manageMRL;
      document.querySelector('#mrl-form input[name="chemical"]').placeholder = dict[lang].chemicalPlaceholder;
      document.querySelector('#mrl-form input[name="species"]').placeholder = dict[lang].mrlSpeciesPlaceholder;
      document.querySelector('#mrl-form input[name="maxResidue"]').placeholder = dict[lang].maxResiduePlaceholder;
      document.querySelector('#mrl-form button').innerHTML = `<i class="fas fa-plus"></i> ${dict[lang].addMRLBtn}`;
      document.getElementById('mrl-search').placeholder = dict[lang].searchMRLPlaceholder;

      // AMU Section
      document.querySelector('#amu-section h3').textContent = dict[lang].logAMU;
      document.querySelector('#amu-form input[name="tagNo"]').placeholder = dict[lang].amuTagNoPlaceholder;
      document.querySelector('#amu-form input[name="chemical"]').placeholder = dict[lang].amuChemicalPlaceholder;
      document.querySelector('#amu-form input[name="date"]').placeholder = dict[lang].amuDatePlaceholder;
      document.querySelector('#amu-form input[name="dosage"]').placeholder = dict[lang].amuDosagePlaceholder;
      document.querySelector('#amu-form button').innerHTML = `<i class="fas fa-plus"></i> ${dict[lang].logAMUBtn}`;
      document.getElementById('amu-search').placeholder = dict[lang].searchAMUPlaceholder;
    }

    setLanguageUI(lang);

    // Handle tab navigation
    function showSection(sectionId) {
      document.querySelectorAll('.tab-section').forEach(s => s.classList.remove('active-section'));
      document.getElementById(sectionId).classList.add('active-section');

      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      const navMap = {
        dashboard: 'navDashboard',
        'livestock-section': 'navLivestock',
        'mrl-section': 'navMRL',
        'amu-section': 'navAMU',
      };
      if (navMap[sectionId]) document.getElementById(navMap[sectionId]).classList.add('active');
    }
    showSection('dashboard');

    document.getElementById('navDashboard').onclick = e => { e.preventDefault(); showSection('dashboard'); };
    document.getElementById('navLivestock').onclick = e => { e.preventDefault(); showSection('livestock-section'); };
    document.getElementById('navMRL').onclick = e => { e.preventDefault(); showSection('mrl-section'); };
    document.getElementById('navAMU').onclick = e => { e.preventDefault(); showSection('amu-section'); };

    document.getElementById('logout-btn').onclick = () => {
      localStorage.removeItem('token');
      window.location.href = 'index.html';
    };

    // In-memory data arrays
    let livestockData = [];
    let mrlData = [];
    let amuData = [];

    // Render functions for tables
    function renderLivestock(data) {
      const tbody = document.querySelector('#livestock-table tbody');
      tbody.innerHTML = data.map(row => `<tr><td>${row.tagNo}</td><td>${row.species}</td><td>${row.breed}</td></tr>`).join('');
    }

    function renderMRL(data) {
      const tbody = document.querySelector('#mrl-table tbody');
      tbody.innerHTML = data.map(row => `<tr><td>${row.chemical}</td><td>${row.species}</td><td>${row.maxResidue}</td></tr>`).join('');
    }

    function renderAMU(data) {
      const tbody = document.querySelector('#amu-table tbody');
      tbody.innerHTML = data.map(row => `<tr><td>${row.tagNo}</td><td>${row.chemical}</td><td>${row.date}</td><td>${row.dosage}</td></tr>`).join('');
    }

    // Filter function
    function filterData(data, searchTerm, keys) {
      searchTerm = searchTerm.toLowerCase();
      return data.filter(item => keys.some(key => item[key].toLowerCase().includes(searchTerm)));
    }

    // Livestock form submit
    document.getElementById('livestock-form').onsubmit = e => {
      e.preventDefault();
      const { species, breed, tagNo } = e.target.elements;
      livestockData.push({ species: species.value, breed: breed.value, tagNo: tagNo.value });
      e.target.reset();
      renderLivestock(livestockData);
    };

    // Livestock search
    document.getElementById('livestock-search').addEventListener('input', e => {
      const filtered = filterData(livestockData, e.target.value, ['species', 'breed', 'tagNo']);
      renderLivestock(filtered);
    });

    // MRL form submit
    document.getElementById('mrl-form').onsubmit = e => {
      e.preventDefault();
      const { chemical, species, maxResidue } = e.target.elements;
      mrlData.push({ chemical: chemical.value, species: species.value, maxResidue: maxResidue.value });
      e.target.reset();
      renderMRL(mrlData);
    };

    // MRL search
    document.getElementById('mrl-search').addEventListener('input', e => {
      const filtered = filterData(mrlData, e.target.value, ['chemical', 'species']);
      renderMRL(filtered);
    });

    // AMU form submit
    document.getElementById('amu-form').onsubmit = e => {
      e.preventDefault();
      const { tagNo, chemical, date, dosage } = e.target.elements;
      amuData.push({ tagNo: tagNo.value, chemical: chemical.value, date: date.value, dosage: dosage.value });
      e.target.reset();
      renderAMU(amuData);
    };

    // AMU search
    document.getElementById('amu-search').addEventListener('input', e => {
      const filtered = filterData(amuData, e.target.value, ['tagNo', 'chemical', 'date', 'dosage']);
      renderAMU(filtered);
    });

    // Initial render
    renderLivestock(livestockData);
    renderMRL(mrlData);
    renderAMU(amuData);
  </script>
</body>
</html>
